# Data & Demo configuration - Hydra instantiate API
# Use _target_ for automatic instantiation via hydra.utils.instantiate

train_dataset:
  _target_: ar_spectra.dataset.OnTheFlySTFTDataset
  audio_dir: /home/ec2-user/cerovaz/data/fma_medium
  target_frames: 128
  sample_rate: 44100
  n_fft: 2048
  hop_length: 512
  win_length: 2048
  center: true
  normalized: false
  extensions: [".mp3"]
  stereo: true
  cac: true
  skip_mismatched_sr: false
  skip_mismatched_channels: false
  custom_metadata_module: ar_spectra.fma_metadata
  custom_metadata_kwargs:
    split: training
    subset: medium

train_dataloader:
  batch_size: 128
  num_workers: 8
  prefetch_factor: 2
  pin_memory: false
  persistent_workers: false
  shuffle: true
  drop_last: true

eval_dataset:
  _target_: ar_spectra.dataset.OnTheFlySTFTDataset
  audio_dir: /home/ec2-user/cerovaz/data/fma_medium
  target_frames: 128
  sample_rate: 44100
  n_fft: 2048
  hop_length: 512
  win_length: 2048
  center: true
  normalized: false
  extensions: [".mp3"]
  stereo: true
  cac: true
  skip_mismatched_sr: false
  skip_mismatched_channels: false
  custom_metadata_module: ar_spectra.fma_metadata
  custom_metadata_kwargs:
    split: validation
    subset: medium

eval_dataloader:
  batch_size: 128
  num_workers: 8
  prefetch_factor: 2
  pin_memory: false
  persistent_workers: false
  shuffle: false
  drop_last: false

# Channel configuration - MUST match dataset settings manually
# stereo=true, cac=false -> audio_channels=2, model_channels=2
# stereo=true, cac=true  -> audio_channels=2, model_channels=4
# stereo=false, cac=false -> audio_channels=1, model_channels=1
# stereo=false, cac=true  -> audio_channels=1, model_channels=2
audio_channels: 2
model_channels: 4

demo:
  every_n_epochs: 1
  max_demos: 7
  target_seconds: 2
  istft_params:
    sample_rate: 44100
    fft_size: 2048
    hop_length: 512
    win_length: 2048
    target_frames: 128
    center: true
    normalized: false
    cac: true
  save_basename: recon_val
